!function(){"use strict";window.XHR={_init:function(){var e=new XMLHttpRequest;return e},post:function(e,t){var n=this._init();t=t||function(){},n.open("POST",e.url,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(e.data),n.onreadystatechange=function(){200===n.status&&4===n.readyState&&t(n.responseText)}},getJSON:function(e,t){var n=this._init();e.url=e.url||location.href,t=t||function(){},e.type=e.type||"json";var o=e.url;if("jsonp"===e.type){window.jsonCallback=t;var a=o.replace("callback=?","callback=jsonCallback"),r=document.createElement("script");r.src=a,document.body.appendChild(r)}n.open("GET",e.url,!0),n.send(),n.onreadystatechange=function(){200===n.status&&4===n.readyState&&t(n.responseText)}}}}(),function(e,t,n){"use strict";function o(e){return t.getElementById(e)}function a(){s.value=p(s.value)}function r(t,n){s=t,p=n,e.setTimeout(a,1)}function i(e){return e=e.replace(/\D/g,""),e=e.replace(/^(\d{5})(\d)/,"$1-$2")}function u(e){return e=e.replace(/\D/g,""),e=e.replace(/^(\d{2})(\d)/g,"($1) $2"),e=e.replace(/(\d)(\d{4})$/,"$1-$2")}function c(e){var t=o("address");t.innerHTML="Não foi possível obter sua posição."}function l(e){var t="geo/"+e.coords.latitude+","+e.coords.longitude+"&callback=?",n=o("cep"),a=o("address");n.value="Procurando..",XHR.getJSON({url:t},function(e){var t=JSON.parse(e);a.innerHTML=t.address,n.value=t.cep})}var s,p;e.onload=function(){var n=o("nome"),a=o("sobrenome"),s=o("telefone"),p=o("cep"),f=o("numero"),d=o("email"),v=o("detalhes"),h=t.querySelectorAll('input[name="sabor[]"]'),g=t.querySelector(".tweet"),m=t.querySelector(".like"),y=t.querySelector(".youtube"),k=t.querySelector(".gplus"),b=o("address"),S=o("js-geo"),w=o("phone"),q=o("form"),T=o("no-responsive");h=[].slice.call(h),T.onclick=function(){var e=t.querySelectorAll("meta[name='viewport']");e[0].content="width=960px,initial-scale=0.3,user-scalable=yes"},s.onkeypress=function(){r(this,u)},p.onkeypress=function(){r(this,i)},p.onkeyup=function(){b.innerHTML=""},g.onclick=function(){_gaq.push(["_trackEvent","twitter Button",this.href,this.title])},m.onclick=function(){_gaq.push(["_trackEvent","facebook Button",this.href,this.title])},y.onclick=function(){_gaq.push(["_trackEvent","youtube Button",this.href,this.title])},k.onclick=function(){_gaq.push(["_trackEvent","google plus Button",this.href,this.title])},S.onclick=function(){navigator.geolocation.getCurrentPosition(l,c)},q.onsubmit=function(e){if(e.preventDefault(),""===s.value)return alert("Digite seu telefone para que eu possa te ligar e confirmar teu pedido!!"),s.focus(),!1;if(""===p.value)return alert("Informe o cep, para eu conseguir te entregar"),p.focus(),!1;if(""===d.value)return alert("Me diga seu email =)"),d.focus(),!1;var t="nome="+n.value+"&sobrenome="+a.value+"&telefone="+s.value+"&cep="+p.value+"&numero="+f.value+"&email="+d.value+"&detalhes="+v.value;h.forEach(function(e){e.checked&&(t+="&sabor[]="+e.value)}),XHR.post({url:q.getAttribute("action"),data:t},function(e){var t=JSON.parse(e);"ok"===t.status?alert("Tudo certo! já já lhe enviaremos um email para combinar a data de entrega."):alert("Por favor tente novamente, ou nos peça por email strudelfolhadinho@gmail.com")})},XHR.getJSON({url:"/telephone"},function(e){var t=JSON.parse(e);w.innerHTML='<i class="ico-phone"></i>'+t.telephone}),e.scrollTo(0,1),w.setAttribute("href",o("phone").getAttribute("data-href")),w.removeAttribute("data-href"),navigator.geolocation&&(S.style.display="block")}}(window,document);